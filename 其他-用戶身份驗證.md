# 用戶身份驗證(登入、登出、API使用權限)

登入流程:
1. 前端呼叫登入API
1. 中間件(Middleware)處理
1. 呼叫登入API Handler

登出流程:
1. ???
1. ???
1. ???

## 1. 前端呼叫登入API
前端呼叫登入API並且傳遞參數(帳號、密碼與權限層級).

> 備註: 權限層級是用來識別用戶權限, 例如管理者或是一般會員身份.

---

## 2. 中間件處理
在呼叫登入API Handler之前, 會先經過中間件(Middleware), 中間件通常會由多組邏輯組合而成.

在登入時會用到的中間件, 處理順序由上至下, 參考下列:
1. Gzip壓縮
1. 檢查來源位址
1. 檢查語系

### 2.1. Gzip壓縮
目的是為了讓封包傳遞的過程中進行資料壓縮, 資料在壓縮後可以減少封包傳遞的時間.
    
> 使用 gin可搭配使用 [github.com/gin-contrib/gzip](https://github.com/gin-contrib/gzip)套件

### 2.2. 檢查來源位址
在某些情況下我們的服務需要限制黑名單或白名單 IP, 藉由中間件層的處理, 可以讓我們所有的 API接口在呼叫 API之前都先進行 IP的檢查.

因此 `HTTP API層`檢查 IP的時候會在呼叫 `RPC服務層`的接口, `RPC服務層`的接口會在查詢 DB內的黑白名單IP.

### 2.3. 檢查語系
語系指的是繁體中文、簡體中文、英文...之類. 語系檢查目的是為了讓後續呼叫 API的 Handler判斷應該使用哪種語系. 因此會在中間件先檢查是否有在 HTTP的 `Header`區塊設定語系, 如果沒有則預設一個語系, 這樣在後續呼叫 API的 Ｈandler時就能判斷到底要用哪一個語系.

---

## 3. 呼叫登入API Handler
# 參考
